# Storage Node
이 문서에서는 아래와 같은 가정을 한다.

- Client 기반의 Chain Replication 방식을 사용한다.
- Replica의 수는 3개이며, Storage Node 2개가 Fail될때까지 Availability를 유지할
수 있다.

## Failures

### Chain의 Head가 Fail한 경우


    +--------+   +--------+   +--------+   +--------+   +--------+   +--------+
    |   CL   |   |   SQ   |   |  SN1   |   |  SN2   |   |  SN3   |   |   MR   |
    +--------+   +--------+   +--------+   +--------+   +--------+   +--------+
         |            |            |            |            |            |
         |            |            |            |            |            |
         <--next:ok--->            |            |            |            |
         |            |            |            |            |            |
         +-write:error+-------->   |            |            |            |
        +++           |            |            |            |            |
        | duration to decide if SN1 fails       |            |            |
        | and CL triggers reconfiguration       |            |            |
        | |           |            |            |            |            |
        +++           |            |            |            |            |
      +----------------------------------------------------------------------+
      |reconfiguration|            |            |            |            |  |
      |  +------------+------------>            |            |            |  |
      |  <------------+------------+------------>            |            |  |
      |  <------------+------------+------------+------------>            |  |
      |  <------------+------------+------------+------------+------------>  |
      +----------------------------------------------------------------------+
         |            |            |            |            |            |
         |            |            |            |            |            |
         |            |            |            |            |            |
    +--------+   +--------+   +--------+   +--------+   +--------+   +--------+
    |   CL   |   |   SQ   |   |  SN1   |   |  SN2   |   |  SN3   |   |   MR   |
    +--------+   +--------+   +--------+   +--------+   +--------+   +--------+

위 그림은 SN1에서 SN2를 거쳐 SN3로 이어지는 Chain Replication을 표현한다. 여기서
Chain의 Head, 즉 SN1이 Fail한 경우 CL의 Append 요청은 실패한다. CL은 SN1에
장애가 있음을 판단하고 refconfiguration을 거쳐야 한다. 여기서 두가지 이슈가
있다.

- SN1에 장애가 있음을 확신하기 위한 조건 필요
- Reconfiguration이 짧아야 한다.


